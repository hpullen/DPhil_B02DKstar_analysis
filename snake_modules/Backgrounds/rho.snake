# Make rho efficiency table
rule rho_efficiency_table:
    output: 
        "/home/pullen/analysis/B02DKstar/ANA_resources/Tables/Backgrounds/rho_efficiency.tex"
    input:
        "/home/pullen/analysis/B02DKstar/ANA_scripts/Tables/Backgrounds/make_rho_table.sh",
        expand("/home/pullen/analysis/B02DKstar/Efficiencies/Values/{eff}_efficiency_rho_run{run_num}.param",
               eff = ["acceptance", "selection", "PID"], run_num = ["1", "2"])
    shell:
        "cd /home/pullen/analysis/B02DKstar/ANA_resources/Tables/Backgrounds/;"
        "./make_rho_table.sh"

# Make average efficiency files for rho
rule rho_acceptance_efficiency:
    output:
        "/home/pullen/analysis/B02DKstar/Efficiencies/Values/acceptance_efficiency_rho_run1.param",
        "/home/pullen/analysis/B02DKstar/Efficiencies/Values/acceptance_efficiency_rho_run2.param"
    input:
        "/home/pullen/analysis/B02DKstar/Efficiencies/Generator/rho/Kpi.param"
    shell:
        "cd /home/pullen/analysis/B02DKstar/Efficiencies/Scripts/;"
        "./acceptance_efficiency_rho.sh"

rule rho_selection_efficiency:
    output:
        "/home/pullen/analysis/B02DKstar/Efficiencies/Values/selection_efficiency_rho_run1.param",
        "/home/pullen/analysis/B02DKstar/Efficiencies/Values/selection_efficiency_rho_run2.param"
    input:
        expand("/data/lhcb/users/pullen/B02DKstar/MC/backgrounds/rho/{year}_{mag}/Kpi_selected.root",
               year = ["2012", "2016"], mag = ["up", "down"])
    shell:
        "cd /home/pullen/analysis/B02DKstar/Efficiencies/Selection/;"
        "./RhoSelectionEfficiency;"
        "cd ../Scripts;"
        "./selection_efficiency_rho.sh"

rule rho_PID_efficiency:
    output:
        "/home/pullen/analysis/B02DKstar/Efficiencies/Values/PID_efficiency_rho_run1.param",
        "/home/pullen/analysis/B02DKstar/Efficiencies/Values/PID_efficiency_rho_run2.param"
    input:
        expand("/data/lhcb/users/pullen/B02DKstar/MC/backgrounds/rho/{year}_{mag}/Kpi_selected.root",
               year = ["2012", "2016"], mag = ["up", "down"])
    shell:
        "cd /home/pullen/analysis/B02DKstar/Efficiencies/PID/Efficiency_calculations/;"
        "./process_rho.sh;"
        "cd ../../Scripts;"
        "./PID_efficiency_rho.sh"
